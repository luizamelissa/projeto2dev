import{a as V,r as x,X as U,f as u,h as e,F as C,D,t as I,o as i,G as A,N as F,v as l,k as p,L as Q,w as L,j as o,q as S,g as b,I as K,af as g,n as w,ak as k}from"./app-eQbeWD5H.js";import{L as H,a as M,b as P}from"./lineChartData-BuVekpNq.js";import{A as j}from"./arrayUtil-CKU0aNL-.js";import{E as N,a as O}from"./index-VRqMfdzO.js";import{u as z}from"./resultUIStore-B99m8FiP.js";import"./objectUtil-Z6JRxuBJ.js";import"./viewUtil-B7upAtw9.js";import"./constants-Bw-uDUhc.js";import"./index-BOPAf95y.js";import"./_baseIteratee-CPsVIgij.js";import"./isEqual-CLYQoJlu.js";import"./merge-n0rrKiL5.js";import"./_initCloneObject-CEcXreET.js";import"./isArrayLikeObject-CFDQt_XA.js";import"./index-D9z2151g.js";import"./DatabaseType-mO-SQkME.js";import"./wrapper-CpU0l5lg.js";const X={class:"pl-4"},G={class:"flex flex-col gap-y-1"},R={class:"var-name"},W={class:"select-all"},J=V({__name:"MySQLBasic",props:{variableList:{}},setup(B){const f=B,t=x({}),a=[{name:"Port",value:"report_port"},{name:"Version",value:"version"},{name:"Slow Query Log",value:"slow_query_log"},{name:"Performance Schema",value:"performance_schema"},{name:"Base Directory",value:"basedir"},{name:"Data Directory",value:"datadir"}];U(()=>{t.value=j.arrayToObj(f.variableList.rows,s=>s.Variable_name,"Value")});const h=s=>t.value[s];return(s,n)=>(i(),u("div",X,[n[0]||(n[0]=e("div",{class:"mb-2"}," Server Infos: ",-1)),e("div",G,[(i(),u(C,null,D(a,v=>e("div",{key:v.name,class:"flex gap-x-2 flex-wrap shrink-0"},[e("div",R,I(v.name)+":",1),e("div",W,I(h(v.value)),1)])),64))])]))}}),Y=A(J,[["__scopeId","data-v-f9336731"]]),Z={class:"pl-2 my-1"},tt={class:"text-center"},et=V({__name:"Process",setup(B){const f=x(0),t=x({fields:[],rows:[],supportKill:!1});function a(s){return s.match(/SQL|INFO|SQL_TEXT/i)?null:s==="Host"?150:100}function h(s){l.emit("killProcess",s)}return F(()=>{l.on("processList",n=>{t.value=n}),l.emit("processList");const s=()=>{f.value=window.innerHeight-110};s(),window.addEventListener("resize",s)}),(s,n)=>{const v=Q("vsc-button"),$=Q("vsc-tooltip"),y=O,d=N;return i(),u("div",null,[e("div",Z,[p($,{title:s.$t("common.refresh")},{default:L(()=>[p(v,{type:"icon",icon:"codicon-refresh text-base",onClick:n[0]||(n[0]=m=>o(l).emit("processList"))})]),_:1},8,["title"])]),p(d,{data:t.value.rows,height:f.value,border:""},{default:L(()=>[(i(!0),u(C,null,D(t.value.fields,(m,r)=>(i(),S(y,{key:r,prop:m.name,label:m.name,align:"center",width:a(m.name)},null,8,["prop","label","width"]))),128)),t.value.supportKill?(i(),S(y,{key:0,label:"Action",align:"center",width:"70"},{default:L(({row:m})=>[e("div",tt,[p(v,{type:"icon",icon:"codicon-debug-stop",class:"red",title:"Kill",onClick:r=>h(m)},null,8,["onClick"])])]),_:1})):b("",!0)]),_:1},8,["data","height"])])}}}),st={class:"status-container"},at={class:"tab"},it={class:"flex flex-row",style:{height:"45vh","margin-top":"10px"}},ot={class:"basis-1/3"},lt={class:"basis-2/3"},nt={style:{height:"300px"}},rt={class:"flex"},ct={class:"basis-full"},ut={style:{height:"300px"}},Bt=V({__name:"status",setup(B){const f=z(),t=x("processList"),a=K({info:{dbType:null},process:{fields:[],rows:[]},variableList:{fields:[],rows:[]},statusList:{fields:[],rows:[]}}),h=new H,s=new H;function n(){d.dashBoard&&l.emit("dashBoard")}function v(){return window.innerHeight-80}const $=h.toChartData(),y=s.toChartData(),d=f.monitorStatus;function m(){n(),l.emit("processList"),d.variableList&&l.emit("variableList"),d.statusList&&l.emit("statusList")}return l.on("info",r=>{a.info=r,d[t.value]||(t.value="processList"),m()}).on("variableList",r=>{a.variableList=r}).on("statusList",r=>{a.statusList=r}).on("dashBoard",r=>{s.addData(r.traffic),h.addData(r.queries)}).init("status"),window.addEventListener("focus",()=>{l.init("status")}),m(),setTimeout(()=>n(),1e3),setInterval(()=>n(),3e3),(r,c)=>{const E=O,q=N;return i(),u("div",st,[e("ul",at,[o(d).dashBoard?(i(),u("li",{key:0,class:w(["tab__item",{"tab__item--active":t.value=="dashBoard"}]),onClick:c[0]||(c[0]=_=>{t.value="dashBoard",n()})}," Dashboard ",2)):b("",!0),o(d).processList?(i(),u("li",{key:1,class:w(["tab__item",{"tab__item--active":t.value=="processList"}]),onClick:c[1]||(c[1]=_=>{t.value="processList",o(l).emit("processList")})}," ProcessList ",2)):b("",!0),o(d).variableList?(i(),u("li",{key:2,class:w(["tab__item",{"tab__item--active":t.value=="variableList"}]),onClick:c[2]||(c[2]=_=>{t.value="variableList",o(l).emit("variableList")})}," VariableList ",2)):b("",!0),o(d).statusList?(i(),u("li",{key:3,class:w(["tab__item",{"tab__item--active":t.value=="statusList"}]),onClick:c[3]||(c[3]=_=>{t.value="statusList",o(l).emit("statusList")})}," StatusList ",2)):b("",!0)]),g(e("div",null,[e("div",it,[e("div",ot,[p(Y,{variableList:a.variableList},null,8,["variableList"])]),e("div",lt,[c[4]||(c[4]=e("span",{class:"select-none"},"Traffic:",-1)),e("div",nt,[p(o(P),{options:o(M).getOption(!0),data:o(y)},null,8,["options","data"])])])]),e("div",rt,[e("div",ct,[c[5]||(c[5]=e("span",{class:"select-none"},"Queries:",-1)),e("div",ut,[p(o(P),{options:o(M).getOption(),data:o($)},null,8,["options","data"])])])])],512),[[k,["MariaDB","MySQL"].includes(a.info.dbType)&&t.value=="dashBoard"]]),g(p(et,null,null,512),[[k,t.value=="processList"]]),g(e("div",null,[p(q,{data:a.variableList.rows,"cell-style":{height:"35px"},style:{width:"100%"},height:v()},{default:L(()=>[(i(!0),u(C,null,D(a.variableList.fields,(_,T)=>(i(),S(E,{key:T,prop:_.name,label:_.name,align:"center"},null,8,["prop","label"]))),128))]),_:1},8,["data","height"])],512),[[k,a.info.dbType!="SqlServer"&&t.value=="variableList"]]),g(e("div",null,[p(q,{data:a.statusList.rows,"cell-style":{height:"35px"},style:{width:"100%"},height:v()},{default:L(()=>[(i(!0),u(C,null,D(a.statusList.fields,(_,T)=>(i(),S(E,{key:T,prop:_.name,label:_.name,align:"center"},null,8,["prop","label"]))),128))]),_:1},8,["data","height"])],512),[[k,a.info.dbType!="SqlServer"&&t.value=="statusList"]])])}}});export{Bt as default};
