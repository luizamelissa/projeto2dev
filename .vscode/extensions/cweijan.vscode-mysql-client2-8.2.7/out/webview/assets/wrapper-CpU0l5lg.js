import"./constants-Bw-uDUhc.js";import{a as l,c as i,d as S}from"./viewUtil-B7upAtw9.js";import{D as s,d as u,a as A}from"./DatabaseType-mO-SQkME.js";function U(r){return r==null?!0:typeof r=="string"?["","NULL","undefined"].includes(r.toUpperCase()):!1}function o(r,e){if(c(r)&&typeof e=="string"){if(/boolean/i.test(r)){if(/^true$/i.test(e))return!0;if(/^false$/i.test(e))return!1}const n=/float|double|decimal/i.test(r)||e.includes(".")?parseFloat(e):parseInt(e);if(n!=null&&!isNaN(n))return n>Number.MAX_SAFE_INTEGER||n<Number.MIN_SAFE_INTEGER?e:n}return null}function E(r){return typeof r!="string"?r:r.replace(/ /g," ")}function M(r){return typeof r!="string"?r:r.replace(/(^'|'$)/g,"")}class m{isSupport(e){return l(e)}convert(e,t,n){if(t.startsWith("0x")){const a=t.slice(2);switch(n){case s.PG:return`'\\x${a}'`;case s.REDSHIFT:return`from_hex('${a}')`;case s.libSQL:case s.SQLITE:case s.DUCK_DB:return`x'${a}'`;case s.SNOWFLAKE:return`TO_BINARY('${a}', 'hex')`}return t}else switch(n){case s.DB2:return`CAST('${t}' AS BLOB)`;case s.SQLServer:return`CAST('${t}' AS varbinary)`;case s.DM:case s.ORACLE:return`rawtohex('${t}')`;case s.CASSANDRA:return`textAsBlob('${t}')`}}}class T{isSupport(e){return e.match(/DATE/i)!=null}convert(e,t,n){switch(n){case s.TRINO:return`from_iso8601_timestamp('${t}')`;case s.ORACLE:return`TO_DATE('${t}','yyyy/mm/dd hh24:mi:ss')`}}}class N{isSupport(e,t,n){return n==s.ORACLE&&e.match(/TIMESTAMP/i)!=null}convert(e,t,n){return`TO_TIMESTAMP('${t}','yyyy/mm/dd hh24:mi:ss')`}}class p{isSupport(e,t,n){return[s.ES,s.MONGO_DB].includes(n)}convert(e,t,n){return o(e,t)??t}}class C{isSupport(e,t,n){return!0}convert(e,t,n){typeof t=="string"&&(t=t.replace(/'/g,"''"));const a=`'${t}'`;return u(n)?a.replace(/\\/g,"\\\\"):a}}class R{isSupport(e,t,n){return c(e)}convert(e,t,n){return o(e,t)}}class D{isSupport(e,t,n){return/bit/i.test(e)}convert(e,t,n){return u(n)?`b'${t}'`:A(n)?`B'${t}'`:n==s.SQLServer&&typeof t=="string"&&(t!=null&&t.match(/true|false/i))?`'${t}'`:t}}class b{isSupport(e,t,n){return/^(bool|boolean)$/i.test(e)&&/true|false/i.test(t)}convert(e,t,n){return t}}class _{isSupport(e){return!0}convert(e,t,n){switch(n){case s.CASSANDRA:if(e!=null&&e.match(/uuid/i))return t;break;case s.PG:case s.REDSHIFT:if(t.includes("nextval("))return t;break;case s.SQLServer:if(i(e))return`N'${t.replace(/'/g,"''")}'`;break;case s.TRINO:if(e!=null&&e.match(/json/i))return`json_parse('${t.replace(/'/g,"''").replace(/ /g," ").replace(/\\/g,"\\\\")}')`;break}}}class I{isSupport(e,t,n){return u(n)&&S(e)}convert(e,t,n){if(t.match(/\w+\(/))return`ST_GeomFromText('${t}')`}}const L=[new p,new D,new R,new b,new m,new T,new N,new I,new _,new C];function $(r,e,t){r||(r=""),e=`${e}`;for(const n of L)if(n.isSupport(r,e,t)){const a=n.convert(r,e,t);if(a!=null)return a}}const w=new Set(["ACCOUNT","ACTION","ALL","ANY","BACKUP","BEGIN","CHARACTER","CONDITION","CURRENT","DATA","DATE","DESC","EXPLAIN","FROM","GRANT","GROUP","GROUPS","INDEX","JOIN","KEY","LENGTH","ORDER","PRIMARY","REGEXP","SIGNAL","SOURCE","SYSTEM","TABLE","TYPE","UNION","USER","VALUE","DATABASE","SCHEMA","VIEW","PROCEDURE","FUNCTION","TRIGGER","EVENT","SEQUENCE","COLUMN","DEFAULT","SET","TEMPORARY"]);var h=(r=>(r.True="true",r.False="false",r.Never="never",r.Always="always",r.Auto="auto",r))(h||{});function f(r){return r!=null&&r.includes(".")?r.split(".").map(e=>f(e)).join("."):r==null?void 0:r.replace(/^[`"\[](.+?)[`"\]]$/,"$1")}function F(r,e,t=!0){if(r==null||["MongoDB"].includes(e)||t=="never"||(t==!0&&(t="always"),t==!1&&(t="auto"),e==s.JDBC&&t=="auto"))return r;const n=r.match(/[A-Z]/g)&&![s.SNOWFLAKE,s.ORACLE,s.DM,s.DB2,s.AS400,s.EXASOL].includes(e),a=/[~!@#$%^&*()/\s\|,.<>?"'();:+\-=\[\]{}]/;return t=="always"||n||r.match(a)||w.has(r.toUpperCase())?(r=f(r),[s.MYSQL,s.MARIA_DB,s.DORIS,s.NEO4J,s.BIG_QUERY,s.DATABRICKS,s.TDengine].includes(e)?`\`${r}\``:`"${r}"`):r}function G(r,e,t){if(e==null||e===""&&!i(r))return"null";typeof e=="object"&&(e!=null&&e.origin)&&(e=e.origin),e=E(e);const n=$(r,e,t);if(n!=null)return n}function d(r,e){return c(e)?r:`'${r}'`}function c(r){if(!r||typeof r=="number"||r.includes("[]")||r=="interval")return!1;const e=["int","number","numeric","serial","float","double","decimal","real","bool","boolean"];return!r.match(/point/i)&&r.match(new RegExp(e.join("|"),"i"))!=null}export{h as E,M as a,F as b,U as c,d as g,c as i,o as s,E as t,G as w};
